<html><!-- Demo with two agents -->
<head>
	<link rel="StyleSheet" href="styles.css" type="text/css">
	<script language="javascript" src="jquery-1.2.6.js"></script>
	<script language="javascript" src="sha1.js"></script>
	<script language="javascript" src="demo_helpers.js"></script>
	<script language="javascript" src="response.js"></script>
	<script language="javascript" src="agent.js"></script>
	<script language="javascript" src="proto_dns.js"></script>
	<script language="javascript" src="proto_ddns.js"></script>
	<script language="javascript" src="proto_sha1hash.js"></script>
	<script language="javascript" src="classes.js"></script>
</head>
<body>
	<div id="sample" style="display: none">
		<p class="a">src</p>
	</div>
	<div id="area">
	</div>
	<div id="log">
	</div>
	<script type="text/javascript"><!--

	// Simulates abstract mapping from scalar address space to objects
	var address_map = {
	};

	// Populate address space
	var a1 = address_map[1] = new Agent( 1, address_map, [ 2 ] );
	address_map[1].add_content( '<html>Including important message: ' +
		'<iframe src="x-sha1hash:e02aa1b106d5c7c6a98def2b13005d5b84fd8dc8">' );
	address_map[1].dump();
	var friend = address_map[2] = new Agent( 2, address_map, [ 1 ] );
	address_map[2].add_content( 'Hello, world' );
	friend.proto( 'x-dns').add_record( 'NS', 'censored.', 'ns.censored.', 1 );
	friend.proto( 'x-dns').add_record( 'A', 'ns.censored.', 'CNS', 1 );
	address_map[2].dump();

	address_map['DR1'] = new Agent( "DR1", address_map, [] );
	address_map['DR1'].dump();
	address_map['DR2'] = new Agent( "DR2", address_map, [] );
	address_map['DR2'].dump();

	var censored_ns = address_map['CNS'] = new Agent( "CNS", address_map, [] );
	censored_ns.proto( 'x-dns' ).add_record( 'A', 'host.censored.', 'CA', 1 );
	censored_ns.dump();
	//var censored_host = address_map['CA'] = new Agent( "CA", address_map, [] );
	//censored_host.dump();

	a1.proto_add( 'x-ddns' );

	// Ordinary DNS
/*
	address_map[1].SHOW( "x-ddns:vasya.tld.?class=IN&type=A");
	address_map[1].SHOW( "x-ddns:vasya.tld.");
	address_map[1].SHOW( "x-ddns:nonexisting.tld.");
	address_map[1].SHOW( "x-ddns:unreachable.other_tld.");
*/

	// DDNS features
	a1.SHOW( "x-ddns:host.censored." );

	log( '--- Playing with 2' );
	address_map[2].SHOW( "x-sha1hash:e02aa1b106d5c7c6a98def2b13005d5b84fd8dc8" );

	//-->
	</script>
</body>
</html>
